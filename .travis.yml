language: c
sudo: false

cache:
  directories:
    - $HOME/.cabal/packages
    - $HOME/.cabal/store

before_cache:
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/build-reports.log
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/00-index.*
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/*.json
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/01-index.cache
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/01-index.tar
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/01-index.tar.idx

addons:
  apt:
    packages:
      - cabal-install-2.0
      - ghc-8.2.1
    sources:
      - hvr-ghc

before_install:
 - unset CC
 - export PATH=/opt/ghc/8.2.1/bin:/opt/cabal/2.0/bin:$PATH
 - cabal update

install:
 - cabal --version
 - cabal new-build --enable-tests --only-dependencies -j

script:
 - cabal new-build --enable-tests -j
 - cabal new-test -j

notifications:
  email: false
